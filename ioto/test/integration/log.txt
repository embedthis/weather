ioto: debug: Loading state/config/ioto.json5
ioto: debug: Loading state/config/web.json5
ioto: debug: Loading state/config/device.json5
ioto: debug: {
    profile: 'dev',
    version: '1.0.0',
    app: 'unit',
    services: { database: true, web: true },
    log: { path: '../log.txt', format: '%M', types: 'error,info,trace', sources: 'all,!mbedtls' },
    api: { builder: 'https://api.admin.embedthis.com/api', serialize: 'http://localhost:4100/ioto/serialize' },
    tls: { certificate: '@certs/test.crt', key: '@certs/test.key' },
    web: {
        auth: { roles: { public: [ ], user: [ ], admin: [ 'user' ], owner: [ 'admin' ], super: [ 'owner' ] } },
        documents: '@site',
        limits: { maxFrame: '100K', maxMessage: '100K' },
        listen: [ 'http://:7090', 'https://:7091' ],
        routes: [
            { match: '/api/admin/', handler: 'action', role: 'admin' },
            { match: '/api/user/', handler: 'action', role: 'user' },
            { match: '/api/', handler: 'action' },
            { match: '/admin/', handler: 'file', role: 'admin' },
            { match: '/user/', handler: 'file', role: 'user' },
            { match: '', handler: 'file', methods: [ 'GET', 'OPTIONS' ] }
        ],
        signatures: { enable: false },
        upload: { dir: 'tmp', remove: true },
        webSockets: { ping: 'never', protocol: 'chat', validateUTF: false }
    },
    device: { product: '01H4R15D3478JD26YDYK408XE6', id: 'ED090EEGXC' }
}
ioto: info: Starting Ioto 3.0.0, with "unit" app 1.0.0, using "dev" profile
ioto: info: Enabling services: db web
fiber: debug: Peak fibers 1
db: debug: {
    version: 'latest',
    description: 'Default database schema for local managememt',
    process: {
        Broadcast: { enable: 'both', sync: 'down', show: true },
        Device: { enable: 'both', sync: 'up', show: false },
        SyncState: { enable: 'device', show: false },
        Store: {
            enable: 'both',
            sync: 'up',
            notify: 'default',
            metrics: [
                {
                    namespace: 'Embedthis/Device',
                    fields: [ { COUNTER: 'value' } ],
                    where: 'key == "counter"',
                    dimensions: [ { Device: 'deviceId' } ],
                    buffer: { count: 5, elapsed: 10 }
                }
            ],
            triggers: [ { name: 'Sync', where: 'key == "counter"' } ],
            show: true
        },
        Service: { enable: 'both', sync: 'up', show: true, triggers: [ { name: 'Sync' } ] }
    },
    models: {
        Broadcast: {
            pk: { type: 'string', value: 'bcast#${accountId}#${deviceId}', hidden: true },
            sk: { type: 'string', value: 'bcast#${key}', hidden: true },
            accountId: { type: 'string', required: true, readonly: true },
            deviceId: { type: 'string', required: true, readonly: true },
            key: { type: 'string', required: true },
            value: { type: 'object', required: true },
            type: { type: 'string', required: true },
            updated: { type: 'date', readonly: true },
            expires: { type: 'date', ttl: true },
            _source: { type: 'string', hidden: true }
        },
        Device: {
            pk: { type: 'string', value: 'd#${accountId}', hidden: true },
            sk: { type: 'string', value: 'd#${id}', hidden: true },
            created: { type: 'date' },
            description: { type: 'string' },
            id: { type: 'string', required: true, readonly: true },
            model: { type: 'string' },
            name: { type: 'string' },
            product: { type: 'string', notes: 'Product Token' },
            updated: { type: 'date', readonly: true },
            _source: { type: 'string', hidden: true }
        },
        SyncState: { sk: { type: 'string', value: 'state#' }, lastSync: { type: 'date' }, lastUpdate: { type: 'date' } },
        Store: {
            pk: { type: 'string', value: 's#${accountId}#${deviceId}', hidden: true },
            sk: { type: 'string', value: 's#${key}', hidden: true },
            accountId: { type: 'string', required: true, readonly: true },
            created: { type: 'date', readonly: true },
            deviceId: { type: 'string', required: true, readonly: true },
            key: { type: 'string', required: true },
            value: { type: 'object', required: true },
            type: { type: 'string', required: true },
            updated: { type: 'date', readonly: true },
            expires: { type: 'date', ttl: true },
            _source: { type: 'string', hidden: true }
        },
        Service: {
            pk: { type: 'string', value: 'service#', hidden: true },
            sk: { type: 'string', value: 'service#', hidden: true },
            value: { type: 'number' },
            updated: { type: 'date', readonly: true },
            _source: { type: 'string', hidden: true }
        }
    },
    format: 'onetable:1.1.0',
    params: { isoDates: true, nulls: false, typeField: '_type', timestamps: 'update' },
    indexes: {
        primary: { hash: 'pk', sort: 'sk', description: 'Primary index' },
        gs1: { hash: 'gs1pk', sort: 'gs1sk', project: 'all' }
    }
}
web: info: Listening http://:7090
socket: debug: Server bound to :::7090 IPv6
web: info: Listening https://:7091
socket: debug: Server bound to :::7091 IPv6
ioto: info: Ioto ready
fiber: debug: Peak fibers 2
test: info: Running db.update test
test: info: Run test: dbLocal
ioto: info: Ioto exiting
